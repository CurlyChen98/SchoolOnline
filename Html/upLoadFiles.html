<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            /* background-color: chocolate;*/
        }

        #box {
            /* background-color: forestgreen; */
        }

        .title {
            /* background-color: fuchsia; */
        }
    </style>
</head>

<body>
    <div id="box">
        <p>作业提交</p>
        <!-- 伪input:file控件 -->
        <span class="span">
            <button id="select" type="button" class="btn btn-success">File</button>选择上传的文件
        </span>
        <!-- 真input:file控件被隐藏 -->
        <input type="file" style="display: none;" id="file" onchange="fileChange()">
        <input type="text" placeholder="TextShow" id="textShow" p>
        <div id="show">显示等待提交的文件</div>
        <button type="submit" onclick="upFile">Submit</button>

        <a href="https://www.bigcurly.club/SchoolOnline/HomeworkDownload/01%e6%b5%8b%e8%af%951%e7%8f%ad/%e5%8b%be%e8%82%a1%e5%ae%9a%e7%90%86/%e5%8b%be%e8%82%a1%e5%ae%9a%e7%90%86.docx" download>下载</a>
    </div>


    <script>
        let file_form = new FormData();
        let phpurl = "";

        window.onload = function () {
            document.getElementById("select").onclick = function () {
                document.getElementById("file").click();
            }
        }

        function fileChange() {
            var file = document.getElementById("file").files[0];
            if (file) {
                file_form.append("file", file);
            }
            document.getElementById("show").innerHTML = file.name;
            document.getElementById("textShow").value = file.name;
        }

        function createXhr() {
            if (window.XMLHttpRequest) {
                //code buy 市面上的浏览器
                var Xhr = new window.XMLHttpRequest;
            } else {
                //code buy IE8以下
                var Xhr = new ActiveXObject("Microsoft.XMLHttp");
            }
            return Xhr;
        }

        function upFile() {
            let text = document.getElementById("textShow").value;
            if (text == "") {
                text = "doNotChange";
            }
            file_form.append("text", JSON.stringify(text));

            var xhr = createXhr();
            xhr.open("post", phpurl, true);
            xhr.onload = function () {
                var get = JSON.parse(xhr.responseText)
            }
            // xhr.send(file_form);
            console.log(file_form)
        }
    </script>
</body>

</html>